console.log("running module: attachment.js");
var attachment=function(){function c(b){util.checkSuccess("Delete attachment",b)&&(view.refreshTree(null,!1),a.closeUploadPg())}function b(b){util.checkSuccess("Upload from URL",b)&&(view.refreshTree(null,!1),a.closeUploadPg())}var a={uploadNode:null,deleteAttachment:function(){confirmPg.areYouSure("Confirm Delete Attachment","Delete the Attachment on the Node?","Yes, delete.",function(){util.json("deleteAttachment",{nodeId:a.uploadNode.id},c)})},uploadFileNow:function(){var d=$("#uploadFromUrl").val();
d?util.json("uploadFromUrl",{nodeId:a.uploadNode.id,sourceUrl:d},b):($("#uploadFormNodeId").attr("value",a.uploadNode.id),d=$.ajax({url:postTargetUrl+"upload",type:"POST",data:new FormData($("#uploadForm")[0]),enctype:"multipart/form-data",processData:!1,contentType:!1,cache:!1}),d.done(function(){view.refreshTree(null,!1);a.closeUploadPg()}),d.fail(function(){alert("Upload failed.")}))},openUploadPg:function(){var b=meta64.getHighlightedNode();b?(a.uploadNode=b,meta64.changePage(uploadPg)):(a.uploadNode=
null,alert("No node is selected."))},closeUploadPg:function(){meta64.jqueryChangePage("#mainPage");view.scrollToSelectedNode()}};console.log("Module ready: attachment.js");return a}();console.log("running module: cnst.js");var cnst=function(){var c={ANON:"anonymous",COOKIE_LOGIN_USR:cookiePrefix+"loginUsr",COOKIE_LOGIN_PWD:cookiePrefix+"loginPwd",COOKIE_LOGIN_STATE:cookiePrefix+"loginState",BR:"<div class='vert-space'></div>",INSERT_ATTACHMENT:"{{insert-attachment}}",NEW_ON_TOOLBAR:!1,INS_ON_TOOLBAR:!1};console.log("Module ready: cnst.js");return c}();console.log("running module: edit.js");
var edit=function(){var c,b,a=function(a){util.checkSuccess("Save node",a)&&(view.refreshTree(null,!1),meta64.jqueryChangePage("#mainPage"),view.scrollToSelectedNode())},d=function(a){util.checkSuccess("Rename node",a)&&(view.refreshTree(null,!1),meta64.jqueryChangePage("#mainPage"),view.scrollToSelectedNode())},e=function(a){util.checkSuccess("Export",a)&&(alert("Export Successful."),meta64.jqueryChangePage("#mainPage"),view.scrollToSelectedNode())},f=function(a){util.checkSuccess("Import",a)&&(alert("Import Successful."),
view.refreshTree(null,!1),meta64.jqueryChangePage("#mainPage"),view.scrollToSelectedNode())},g=function(a){console.log("insertBookResponse running.");util.checkSuccess("Insert Book",a);view.refreshTree(null,!1);meta64.jqueryChangePage("#mainPage");view.scrollToSelectedNode()},k=function(a){util.checkSuccess("Delete node",a)&&(meta64.clearSelectedNodes(),view.refreshTree(null,!1))},l=function(a){util.checkSuccess("Editing node",a)&&(h.editNode=a.nodeInfo,meta64.changePage(editNodePg))},m=function(a){util.checkSuccess("Move nodes",
a)&&(h.nodesToMove=null,view.refreshTree(null,!1))},n=function(a){util.checkSuccess("Change node position",a)&&(view.refreshTree(null,!1),meta64.jqueryChangePage("#mainPage"),view.scrollToSelectedNode())},p=function(a){util.checkSuccess("Insert node",a)&&(meta64.newChildNodeId=a.newNode.id,meta64.initNode(a.newNode),meta64.highlightNode(a.newNode,!0),h.runEditNode(a.newNode.uid))},q=function(a){util.checkSuccess("Make node referencable",a)&&alert("This node is now referencable, and can be accessed by unique ID")},
r=function(a){util.checkSuccess("Create subnode",a);meta64.newChildNodeId=a.newNode.id;console.log("new child identifier: "+meta64.newChildNodeId);meta64.initNode(a.newNode);h.runEditNode(a.newNode.uid)},h={nodesToMove:null,editingUnsavedNode:!1,editNode:null,nodeInsertTarget:null,startEditingNewNode:function(){h.editingUnsavedNode=!1;h.editNode=null;h.saveNewNode("")},startEditingNewNodeWithName:function(){h.editingUnsavedNode=!0;h.editNode=null;meta64.changePage(editNodePg)},editMode:function(){meta64.editMode=
meta64.editMode?!1:!0;var a=$("#editModeButton");a.toggleClass("ui-icon-edit",meta64.editMode);a.toggleClass("ui-icon-forbidden",!meta64.editMode);render.renderPageFromData();view.scrollToSelectedNode()},makeNodeReferencable:function(){util.json("makeNodeReferencable",{nodeId:h.editNode.id},q)},cancelEdit:function(){meta64.treeDirty&&view.refreshTree(null,!1);meta64.jqueryChangePage("#mainPage");view.scrollToSelectedNode()},saveNode:function(){h.editingUnsavedNode?h.saveNewNode():h.saveExistingNode()},
saveNewNode:function(a){a||(a=util.getRequiredElement("#newNodeNameId").val());meta64.userName!=c.createdBy&&"admin"!=c.createdBy&&(b=!0);meta64.treeDirty=!0;h.nodeInsertTarget?util.json("insertNode",{parentId:c.id,targetName:h.nodeInsertTarget.name,newNodeName:a},p):util.json("createSubNode",{nodeId:c.id,newNodeName:a},r)},saveExistingNode:function(){for(var d=[],e=0,c=0;;){var f="editNodeTextContent"+e;if(meta64.fieldIdToPropMap.hasOwnProperty(f)){var k=meta64.fieldIdToPropMap[f],f=$("#"+f).val();
f!==k.value&&(d.push({name:k.name,value:f}),c++)}else break;e++}0<c?(util.json("saveNode",{nodeId:h.editNode.id,properties:d,sendNotification:b},a),b=!1):alert("You didn't change any information!")},moveNodeUp:function(a){var b=meta64.uidToNodeMap[a];b?(a=meta64.getOrdinalOfNode(b),console.log("ordinal="+a),-1==a&&0>=a||util.json("setNodePosition",{parentNodeId:meta64.currentNodeId,nodeId:b.name,siblingId:meta64.currentNodeData.children[a-1].name},n)):console.log("idToNodeMap does not contain "+a)},
moveNodeDown:function(a){var b=meta64.uidToNodeMap[a];b?(a=meta64.getOrdinalOfNode(b),console.log("ordinal="+a),-1==a&&a>=meta64.currentNodeData.children.length-1||util.json("setNodePosition",{parentNodeId:meta64.currentNodeData.node.id,nodeId:meta64.currentNodeData.children[a+1].name,siblingId:b.name},n)):console.log("idToNodeMap does not contain "+a)},openExportPg:function(){meta64.changePage(exportPg)},openRenameNodePg:function(){meta64.changePage(renameNodePg)},renameNode:function(){var a=$("#newNodeNameEditField").val();
if(util.emptyString(a))alert("Please enter a new node name.");else{var b=meta64.getHighlightedNode();b?util.json("renameNode",{nodeId:b.id,newName:a},d):alert("Select a node to rename.")}},exportNodes:function(){var a=meta64.getHighlightedNode(),b=util.getRequiredElement("#exportTargetNodeName").val();util.emptyString(b)?alert("Please enter a name for the export file."):a&&util.json("exportToXml",{nodeId:a.id,targetFileName:b},e)},openImportPg:function(){meta64.changePage(importPg)},importNodes:function(){var a=
meta64.getHighlightedNode(),b=util.getRequiredElement("#importTargetNodeName").val();util.emptyString(b)?alert("Please enter a name for the import file."):a&&util.json("import",{nodeId:a.id,sourceFileName:b},f)},runEditNode:function(a){var b=meta64.uidToNodeMap[a];b?(h.editingUnsavedNode=!1,util.json("initNodeEdit",{nodeId:b.id},l)):(h.editNode=null,alert("Unknown nodeId in editNodeClick: "+a))},populateEditNodePg:function(){view.initEditPathDisplayById("#editNodePathDisplay");var a="",b=0;meta64.fieldIdToPropMap=
{};if(h.editNode)$.each(h.editNode.properties,function(d,e){if(render.allowPropertyToDisplay(e.name)){var c="editNodeTextContent"+b;meta64.fieldIdToPropMap[c]=e;var f=e.values&&0<e.values.length,k=render.isReadOnlyProperty(e.name),g=render.isBinaryProperty(e.name);if(k||g)c="RdOnly_"+c;var l="";if(!k&&!g){var l=render.makeTag("a",{onClick:"props.clearProperty('"+c+"');","class":"ui-btn ui-btn-inline ui-icon-back ui-btn-icon-left"},"Clear"),h="",m="";e.name!==jcrCnst.CONTENT&&(m=render.makeTag("a",
{onClick:"props.deleteProperty('"+e.name+"');","class":"ui-btn ui-btn-inline ui-icon-delete ui-btn-icon-left"},"Del"),h=render.makeTag("a",{onClick:"props.addSubProperty('"+c+"');","class":"ui-btn ui-btn-inline ui-icon-star ui-btn-icon-left"},"Add Multi"));l=h+l+m;l=0<l.length?render.makeHorizontalFieldSet(l,"property-edit-button-bar"):""}f?(console.log("Property multi-type: name="+e.name+" count="+e.values.length),l+=props.makeMultiPropEditor(c,e,k,g)):(console.log("Property single-type: "+e.name),
l+=render.makeTag("label",{"for":c},render.sanitizePropertyName(e.name)),f=g?"[binary]":e.value,l=k||g?l+render.makeTag("textarea",{id:c,readonly:"readonly",disabled:"disabled"},f?f:""):l+render.makeTag("textarea",{id:c},f?f:""));a+=render.makeTag("div",{"class":"ui-field-contain property-edit-field"},l);b++}else console.log("Hiding property: "+e.name)});else var d=render.makeTag("label",{"for":"newNodeNameId"},"New Node Name")+render.makeTag("textarea",{id:"newNodeNameId"},""),a=a+render.makeTag("div",
{"class":"ui-field-contain property-edit-field"},d);util.setHtmlEnhanced($("#propertyEditFieldContainer"),a);d=h.editingUnsavedNode?"You may leave this field blank and a unique ID will be assigned. You only need to provide a name if you want this node to have a more meaningful URL.":"";$("#editNodeInstructions").html(d);util.setVisibility("#addPropertyButton",!h.editingUnsavedNode);d=h.editNode&&h.editNode.id&&!h.editNode.id.startsWith("/");util.setVisibility("#makeNodeReferencableButton",h.editNode&&
!d&&!h.editingUnsavedNode)},insertNode:function(a){if(c=meta64.currentNode){var b=null;if(b=a?meta64.uidToNodeMap[a]:meta64.getHighlightedNode())h.nodeInsertTarget=b,h.startEditingNewNode()}else console.log("Unknown parent")},createSubNodeUnderHighlight:function(){(c=meta64.getHighlightedNode())?(h.nodeInsertTarget=null,h.startEditingNewNode()):alert("Tap a node to insert under.")},createSubNode:function(a){if(a){if(c=meta64.uidToNodeMap[a],!c){console.log("Unknown nodeId in createSubNode: "+a);return}}else c=
meta64.currentNode;h.nodeInsertTarget=null;h.startEditingNewNode()},clearSelections:function(){meta64.clearSelectedNodes();render.renderPageFromData();meta64.jqueryChangePage("#mainPage")},deleteSelNodes:function(){var a=meta64.getSelectedNodeIdsArray();a&&0!=a.length?confirmPg.areYouSure("Confirm Delete","Delete "+a.length+" node(s) ?","Yes, delete.",function(){util.json("deleteNodes",{nodeIds:a},k)}):alert("You have not selected any nodes. Select nodes to delete first.")},moveSelNodes:function(){var a=
meta64.getSelectedNodeIdsArray();a&&0!=a.length?confirmPg.areYouSure("Confirm Move","Move "+a.length+" node(s) to a new location ?","Yes, move.",function(){h.nodesToMove=a;meta64.selectedNodes={};alert("Ok, ready to move nodes. To finish moving, go select the target location, then click 'Finish Moving'");meta64.refreshAllGuiEnablement()}):alert("You have not selected any nodes. Select nodes to delete first.")},finishMovingSelNodes:function(){confirmPg.areYouSure("Confirm Move","Move "+h.nodesToMove.length+
" node(s) to selected location ?","Yes, move.",function(){var a=meta64.getHighlightedNode();util.json("moveNodes",{targetNodeId:a.id,targetChildId:null!=a?a.id:null,nodeIds:h.nodesToMove},m)})},insertBookWarAndPeace:function(){confirmPg.areYouSure("Confirm","Insert book War and Peace?","Yes, insert book.",function(){var a=meta64.getHighlightedNode();a?util.json("insertBook",{nodeId:a.id,bookName:"War and Peace"},g):alert("No node is selected.")})}};console.log("Module ready: edit.js");return h}();console.log("running module: jcrCnst.js");
var jcrCnst=function(){console.log("Module ready: jcrCnst.js");return{PRIMARY_TYPE:"jcr:primaryType",POLICY:"rep:policy",MIXIN_TYPES:"jcr:mixinTypes",EMAIL_CONTENT:"jcr:content",EMAIL_RECIP:"recip",EMAIL_SUBJECT:"subject",CREATED:"jcr:created",CREATED_BY:"jcr:createdBy",CONTENT:"jcr:content",UUID:"jcr:uuid",LAST_MODIFIED:"jcr:lastModified",LAST_MODIFIED_BY:"jcr:lastModifiedBy",USER:"user",PWD:"pwd",EMAIL:"email",CODE:"code",BIN_VER:"binVer",BIN_DATA:"jcrData",BIN_MIME:"jcr:mimeType",IMG_WIDTH:"imgWidth",
IMG_HEIGHT:"imgHeight"}}();console.log("running module: meta64.js");
var meta64=function(){var c=!1,b={userName:"anonymous",deviceWidth:0,deviceHeight:0,homeNodeId:"",homeNodePath:"",isAdminUser:!1,isAnonUser:!0,anonUserLandingPageNode:null,treeDirty:!1,uidToNodeMap:{},idToNodeMap:{},nextUid:1,identToUidMap:{},parentUidToFocusNodeMap:{},editMode:!1,MODE_ADVANCED:"advanced",MODE_SIMPLE:"simple",editModeOption:"simple",showProperties:!1,simpleModeNodePrefixBlackList:{"rep:":!0},simpleModePropertyBlackList:{},readOnlyPropertyList:{},binaryPropertyList:{},fieldIdToPropMap:{},
selectedNodes:{},newChildNodeId:"",currentNodeData:null,currentNode:null,currentNodeUid:null,currentNodeId:null,currentNodePath:null,inSimpleMode:function(){return b.editModeOption===b.MODE_SIMPLE},jqueryChangePage:function(a){$.mobile.pageContainer.pagecontainer("change",a)},changePage:function(a){render.buildPage(a);$.mobile.pageContainer.pagecontainer("change","#"+a.domId)},openDialog:function(a){render.buildPage(a);$.mobile.changePage("#"+a.domId,{role:"dialog"})},popup:function(){render.buildPage(popupMenuPg);
$("#"+popupMenuPg.domId).popup("open")},isNodeBlackListed:function(a){if(!b.inSimpleMode())return!1;for(var d in b.simpleModeNodePrefixBlackList)if(b.simpleModeNodePrefixBlackList.hasOwnProperty(d)&&a.name.startsWith(d))return!0;return!1},getSelectedNodeUidsArray:function(){var a=[],d=0,e;for(e in b.selectedNodes)b.selectedNodes.hasOwnProperty(e)&&(a[d++]=e);return a},getSelectedNodeIdsArray:function(){var a=[],d=0,e;b.selectedNodes?console.log("selectedNode count: "+b.selectedNodes.length):console.log("no selected nodes.");
for(e in b.selectedNodes)if(b.selectedNodes.hasOwnProperty(e)){var c=b.uidToNodeMap[e];c?a[d++]=c.id:console.log("unable to find uidToNodeMap for uid="+e)}return a},getSelectedNodesArray:function(){var a=[],d=0,e;for(e in b.selectedNodes)b.selectedNodes.hasOwnProperty(e)&&(a[d++]=b.uidToNodeMap[e]);return a},clearSelectedNodes:function(){b.selectedNodes={}},updateNodeInfoResponse:function(a,b){var e="",c=!1;a.owners&&$.each(a.owners,function(a,b){0<e.length&&(e+=",");b===meta64.userName&&(c=!0);e+=
b});if(0<e.length){b.owner=e;var g=$("#ownerDisplay"+b.uid);g.html(" (Manager: "+e+")");c?util.changeOrAddClass(g,"created-by-other","created-by-me"):util.changeOrAddClass(g,"created-by-me","created-by-other")}},updateNodeInfo:function(a){util.json("getNodePrivileges",{nodeId:a.id,includeAcl:!1,includeOwners:!0}).done(function(d){b.updateNodeInfoResponse(d,a)})},getNodeFromId:function(a){return b.idToNodeMap[a]},getPathOfUid:function(a){var d=b.uidToNodeMap[a];return d?d.path:"[path error. invalid uid: "+
a+"]"},addClickListeners:function(){$("#openLoginPgButton").on("click",user.openLoginPg);$("#navHomeButton").on("click",nav.navHome);$("#navUpLevelButton").on("click",nav.navUpLevel);$("#deletePropertyButton").on("click",props.deleteProperty);$("#editModeButton").on("click",edit.editMode)},openDonatePg:function(){meta64.jqueryChangePage("#donatePg")},getHighlightedNode:function(){return b.parentUidToFocusNodeMap[b.currentNodeUid]},highlightRowById:function(a,d){var e=b.getNodeFromId(a);e?b.highlightNode(e,
d):console.log("highlightRowById failed to find id: "+a)},highlightNode:function(a,d){if(a){var e=!1,c=b.parentUidToFocusNodeMap[b.currentNodeUid];c&&(c.uid===a.uid?e=!0:(c=c.uid+"_row",c=$("#"+c),util.changeOrAddClass(c,"active-row","inactive-row")));e||(b.parentUidToFocusNodeMap[b.currentNodeUid]=a,c=a.uid+"_row",c=$("#"+c),util.changeOrAddClass(c,"inactive-row","active-row"));d&&view.scrollToSelectedNode()}},refreshAllGuiEnablement:function(){util.getPropertyCount(b.selectedNodes);var a=b.getHighlightedNode();
util.setEnablement($("#navHomeButton"),b.currentNode&&!nav.displayingHome());util.setEnablement($("#navUpLevelButton"),b.currentNode&&nav.parentVisibleToUser());var d=b.currentNode&&!b.isAnonUser;util.setEnablement($("#propsToggleButton"),d);util.setEnablement($("#deletePropertyButton"),!b.isAnonUser);d=b.currentNode&&!b.isAnonUser;util.setEnablement($("#editModeButton"),d);util.setEnablement($("#insNodeButton"),!b.isAnonUser&&null!=a);util.setEnablement($("#createNodeButton"),!b.isAnonUser&&null!=
a);util.setVisibility("#menuButton",!b.isAnonUser);util.setVisibility("#openSignupPgButton",b.isAnonUser);util.setVisibility("#mainMenuSearchButton",!b.isAnonUser&&null!=a);util.setVisibility("#mainMenuTimelineButton",!b.isAnonUser&&null!=a)},getSingleSelectedNode:function(){for(var a in b.selectedNodes)if(b.selectedNodes.hasOwnProperty(a))return b.uidToNodeMap[a];return null},getOrdinalOfNode:function(a){if(!b.currentNodeData||!b.currentNodeData.children)return-1;for(var d=0;d<b.currentNodeData.children.length;d++)if(a.id===
b.currentNodeData.children[d].id)return d;return-1},setCurrentNodeData:function(a){b.currentNodeData=a;b.currentNode=a.node;b.currentNodeUid=a.node.uid;b.currentNodeId=a.node.id;b.currentNodePath=a.node.path},anonPageLoadResponse:function(a){a.renderNodeResponse?(util.setVisibility("#mainNodeContent",!0),util.setVisibility("#mainNodeStatusBar",!0),render.renderPageFromData(a.renderNodeResponse),b.refreshAllGuiEnablement()):(util.setVisibility("#mainNodeContent",!1),util.setVisibility("#mainNodeStatusBar",
!1),console.log("setting listview to: "+a.content),util.setHtmlEnhanced($("#listView"),a.content));render.renderMainPageControls()},initNode:function(a){a?(a.uid=util.getUidForId(b.identToUidMap,a.id),a.properties=props.setPreferredPropertyOrder(a.properties),b.uidToNodeMap[a.uid]=a,b.idToNodeMap[a.id]=a):console.log("initNode has null node")},initConstants:function(){util.addAll(b.simpleModePropertyBlackList,[jcrCnst.PRIMARY_TYPE,jcrCnst.POLICY]);util.addAll(b.readOnlyPropertyList,[jcrCnst.UUID,
jcrCnst.MIXIN_TYPES,jcrCnst.CREATED,jcrCnst.CREATED_BY,jcrCnst.LAST_MODIFIED,jcrCnst.LAST_MODIFIED_BY,jcrCnst.IMG_WIDTH,jcrCnst.IMG_HEIGHT,jcrCnst.BIN_VER,jcrCnst.BIN_DATA,jcrCnst.BIN_MIME]);util.addAll(b.binaryPropertyList,[jcrCnst.BIN_DATA])},initApp:function(){c||(console.log("initApp running."),c=!0,b.initConstants(),b.displaySignupMessage(),$(window).on("orientationchange",b.orientationHandler),$(window).bind("beforeunload",function(){return"Leave Meta64 ?"}),b.addClickListeners(),b.deviceWidth=
$(window).width(),b.deviceHeight=$(window).height(),user.refreshLogin(),setInterval(function(){var a=$(window).width();a!=b.deviceWidth&&(b.deviceWidth=a,b.deviceHeight=$(window).height(),b.screenSizeChange())},1500),b.refreshAllGuiEnablement())},displaySignupMessage:function(){"ok"===$("#signupCodeResponse").text()&&alert("Signup complete. You may now login.")},screenSizeChange:function(){b.currentNodeData&&(meta64.currentNode.imgId&&render.adjustImageSize(meta64.currentNode),$.each(b.currentNodeData.children,
function(a,b){b.imgId&&render.adjustImageSize(b)}))},orientationHandler:function(a){},loadAnonPageHome:function(a){util.json("anonPageLoad",{ignoreUrl:a},b.anonPageLoadResponse)}};console.log("Module ready: meta64.js");return b}();console.log("running module: nav.js");
var nav=function(){var c={displayingHome:function(){return meta64.isAnonUser?meta64.currentNodeId===meta64.anonUserLandingPageNode:meta64.currentNodeId===meta64.homeNodeId},parentVisibleToUser:function(){return!c.displayingHome()},showSearchPage:function(){meta64.changePage(searchResultsPg)},upLevelResponse:function(b,a){b&&b.node?(render.renderPageFromData(b),meta64.highlightRowById(a,!0),meta64.refreshAllGuiEnablement()):(alert("No data is visible to you above this node."),util.setEnablementByName("navUpLevel",
!1))},navUpLevel:function(){c.parentVisibleToUser()&&util.json("renderNode",{nodeId:meta64.currentNodeId,upLevel:1}).done(function(b){c.upLevelResponse(b,meta64.currentNodeId)})},getSelectedDomElement:function(){var b=meta64.getHighlightedNode();return b&&(b=meta64.uidToNodeMap[b.uid])?util.domElm(b.uid+"_row"):null},clickOnNodeRow:function(b,a){var d=meta64.uidToNodeMap[a];d?(meta64.highlightNode(d,!1),meta64.editMode&&!d.owner&&(console.log("calling updateNodeInfo"),meta64.updateNodeInfo(d)),meta64.refreshAllGuiEnablement()):
console.log("clickOnNodeRow recieved uid that doesn't map to any node. uid="+a)},openNode:function(b){var a=meta64.uidToNodeMap[b];meta64.highlightNode(a,!0);a?view.refreshTree(a.id,!1):alert("Unknown nodeId in openNode: "+b)},toggleNodeSel:function(b){if(util.getRequiredElement()){var a=$("#"+b+"_sel"),d=a.attr("class").contains("ui-btn-b");d?(util.changeOrAddClass(a,"ui-btn-b","ui-btn-a"),d=!1):(util.changeOrAddClass(a,"ui-btn-a","ui-btn-b"),d=!0);d?meta64.selectedNodes[b]=!0:delete meta64.selectedNodes[b];
a.enhanceWithin();view.updateStatusBar();meta64.refreshAllGuiEnablement()}else console.log("Unable to find Sel button for uid: "+b)},navHomeResponse:function(b){meta64.clearSelectedNodes();render.renderPageFromData(b);util.scrollToTop();meta64.refreshAllGuiEnablement()},navHome:function(){meta64.isAnonUser?meta64.loadAnonPageHome(!0):util.json("renderNode",{nodeId:meta64.homeNodeId},c.navHomeResponse)}};console.log("Module ready: nav.js");return c}();console.log("running module: changePasswordPg.js");
var changePasswordPg=function(){console.log("Module ready: changePasswordPg.js");return{domId:"changePasswordPg",build:function(){var c=render.makeTag("div",{"data-role":"header"},"<h2>"+BRANDING_TITLE+" - Login</h2>"),b=render.makePasswordField("Password","changePassword1")+render.makePasswordField("Repeat Password","changePassword2"),a=render.makeButton("Change Password","changePasswordActionButton","b","ui-btn-icon-left ui-icon-check"),d=render.makeBackButton("Close","cancelChangePasswordButton",
"a"),a=render.makeHorzControlGroup(a+d),b=render.makeTag("div",{"class":"ui-field-contain"},b+a),b=render.makeTag("div",{role:"main","class":"ui-content dialog-content"},""+b),c=c+b;util.setHtmlEnhanced($("#changePasswordPg"),c);$("#changePasswordActionButton").on("click",user.changePassword)},init:function(){util.delayedFocus("#changePassword1")}}}();console.log("running module: confirmPg.js");
var confirmPg=function(){var c,b,a,d;console.log("Module ready: confirmPg.js");return{domId:"confirmPg",areYouSure:function(e,f,g,k){c=e;b=f;a=g;d=k;meta64.openDialog(confirmPg)},build:function(){var a;a="<h3 id='confirmPgTitle'></h3><p id='confirmPgMessage'></p>"+render.makeBackButton("Yes","confirmPgYesButton","b");a+=render.makeBackButton("No","confirmPgNoButton","a");a=render.makeTag("div",{"data-role":"content"},a);util.setHtmlEnhanced($("#confirmPg"),a);$("#confirmPgYesButton").on("click",function(){d()})},
init:function(){$("#confirmPgTitle").text(c);$("#confirmPgMessage").text(b);$("#confirmPgYesButton").text(a)}}}();console.log("running module: editNodePg.js");
var editNodePg=function(){console.log("Module ready: editNodePg.js");return{domId:"editNodePg",build:function(){var c=render.makeTag("div",{"data-role":"header"},"<h2>"+BRANDING_TITLE+" - Edit Node</h2>"),b=render.makeButton("Save","saveNodeButton","b","ui-btn-icon-left ui-icon-check"),a=render.makeButton("Add Property","addPropertyButton","a"),d=render.makeButton("Make Node Referencable","makeNodeReferencableButton","a"),e=render.makeButton("Close","cancelEditButton","a"),b=render.makeHorzControlGroup(b+
a+d+e),b=render.makeTag("div",{role:"main","class":"ui-content dialog-content"},"<div id='editNodePathDisplay' class='path-display-in-editor'></div><div id='editNodeInstructions'></div><div id='propertyEditFieldContainer'></div>"+b),c=c+b;util.setHtmlEnhanced($("#editNodePg"),c);$("#saveNodeButton").on("click",edit.saveNode);$("#cancelEditButton").on("click",edit.cancelEdit);$("#addPropertyButton").on("click",props.addProperty);$("#makeNodeReferencableButton").on("click",edit.makeNodeReferencable)},
init:function(){edit.populateEditNodePg()}}}();console.log("running module: editPropertyPg.js");
var editPropertyPg=function(){console.log("Module ready: editPropertyPg.js");return{domId:"editPropertyPg",build:function(){var c=render.makeTag("div",{"data-role":"header"},"<h2>"+BRANDING_TITLE+" - Edit Node Property</h2>"),b=render.makeButton("Save","savePropertyButton","b","ui-btn-icon-left ui-icon-check"),a=render.makeBackButton("Cancel","editPropertyPgCloseButton","a"),b=render.makeHorzControlGroup(b+a),b=render.makeTag("div",{role:"main","class":"ui-content dialog-content"},"<div id='editPropertyPathDisplay' class='path-display-in-editor'></div><div id='addPropertyFieldContainer' class='ui-field-contain'></div>"+
b),c=c+b;util.setHtmlEnhanced($("#editPropertyPg"),c);$("#savePropertyButton").on("click",props.saveProperty)},init:function(){props.populatePropertyEdit()}}}();console.log("running module: exportPg.js");
var exportPg=function(){console.log("Module ready: exportPg.js");return{domId:"exportPg",build:function(){var c=render.makeTag("div",{"data-role":"header"},"<h2>"+BRANDING_TITLE+" - Export to XML</h2>"),b=render.makeEditField("Export to File Name","exportTargetNodeName"),a=render.makeButton("Export","exportNodesButton","b"),d=render.makeBackButton("Close","cancelExportButton","a"),a=render.makeHorzControlGroup(a+d),b=render.makeTag("div",{"class":"ui-field-contain"},b+a),b=render.makeTag("div",{role:"main",
"class":"ui-content dialog-content"},""+b),c=c+b;util.setHtmlEnhanced($("#exportPg"),c);$("#exportNodesButton").on("click",edit.exportNodes)}}}();console.log("running module: importPg.js");
var importPg=function(){console.log("Module ready: importPg.js");return{domId:"importPg",build:function(){var c=render.makeTag("div",{"data-role":"header"},"<h2>"+BRANDING_TITLE+" - Import from XML</h2>"),b=render.makeEditField("Import Target Node Name","importTargetNodeName"),a=render.makeButton("Import","importNodesButton","b"),d=render.makeBackButton("Close","cancelImportButton","a"),a=render.makeHorzControlGroup(a+d),b=render.makeTag("div",{"class":"ui-field-contain"},b+a),b=render.makeTag("div",
{role:"main","class":"ui-content dialog-content"},""+b),c=c+b;util.setHtmlEnhanced($("#importPg"),c);$("#importNodesButton").on("click",edit.importNodes)}}}();console.log("running module: loginPg.js");
var loginPg=function(){console.log("Module ready: loginPg.js");return{domId:"loginPg",build:function(){var c=render.makeTag("div",{"data-role":"header"},"<h2>"+BRANDING_TITLE+" - Login</h2>"),b=render.makeEditField("User","userName")+render.makePasswordField("Password","password"),a=render.makeButton("Login","loginButton","b","ui-btn-icon-left ui-icon-check"),d=render.makeBackButton("Close","cancelLoginButton","a"),a=render.makeHorzControlGroup(a+d),d=render.makeButton("Twitter","twitterLoginButton",
"a","ui-btn-icon-left ui-icon-user"),d=render.makeHorzControlGroup(d),b=render.makeTag("div",{"class":"ui-field-contain"},b+a),b=render.makeTag("div",{role:"main","class":"ui-content dialog-content"},""+b+"<div><h3>Or Login With...</h3></div>"+d),c=c+b;util.setHtmlEnhanced($("#loginPg"),c);$("#loginButton").on("click",user.login);$("#twitterLoginButton").on("click",user.twitterLogin);util.bindEnterKey("#userName",user.login);util.bindEnterKey("#password",user.login)},init:function(){user.populateLoginPgFromCookies();
util.delayedFocus("#userName")}}}();console.log("running module: messagePg.js");
var messagePg=function(){var c,b,a;console.log("Module ready: messagePg.js");return{domId:"messagePg",showMessage:function(d,e,f){c=d;b=e;a=f;meta64.openDialog(messagePg)},build:function(){var b;b="<h3 id='messagePgTitle'></h3><p id='messagePgMessage'></p>"+render.makeBackButton("Ok","messagePgOkButton","b");b=render.makeTag("div",{"data-role":"content"},b);util.setHtmlEnhanced($("#messagePg"),b);$("#messagePgOkButton").on("click",function(){a()})},init:function(){$("#messagePgTitle").text(c);$("#messagePgMessage").html(b);
$("#messagePgOkButton").text(_buttonText)}}}();console.log("running module: popupMenuPg.js");
var popupMenuPg=function(){function c(a,b){return render.makeTag("div",{style:"margin: 0px; padding: 0px;","data-role":"collapsible","data-iconpos":"right","data-shadow":"false","data-corners":"false"},"<h2 style='margin: 0px; padding: 0px;'>"+a+"</h2>"+render.makeTag("ul",{style:"margin: 0px; padding: 0px;","data-role":"listview","data-inset":"true","data-shadow":"false","data-corners":"false"},b))}function b(a,b,c){a=render.makeTag("a",{id:b,onclick:c},a);return render.makeTag("li",{"data-icon":"false"},
a)}var a={domId:"popupMenuPg",build:function(){var a=b("Change Password","changePasswordPgButton","user.changePasswordPg();")+b("Preferences","accountPreferencesPgButton","prefs.accountPreferencesPg();")+b("Insert Book: War and Peace","insertBookWarAndPeaceButton"," edit.insertBookWarAndPeace();")+b("Donate","donatePgButton","meta64.openDonatePg();"),a=c("My Account",a),e=b("Attachments","manageAttachmentsButton","attachment.openUploadPg();")+b("Sharing","editNodeSharingButton","share.editNodeSharing();")+
b("Move","moveSelNodesButton","edit.moveSelNodes();")+b("Finish Moving","finishMovingSelNodesButton","edit.finishMovingSelNodes();")+b("Rename","renameNodePgButton","edit.openRenameNodePg();")+b("Delete","deleteSelNodesButton","edit.deleteSelNodes();")+b("Clear Selections","clearSelectionsButton","edit.clearSelections();")+b("Import","openImportPgButton","edit.openImportPg();")+b("Export","openExportPgButton","edit.openExportPg();"),e=c("Edit",e),f=b("Toggle Properties","propsToggleButton","props.propsToggle();")+
b("Refresh","refreshPageButton","view.refreshPage();")+b("Show URL","showFullNodeUrlButton","render.showNodeUrl();"),f=c("View Options",f),a=render.makeTag("div",{style:"margin: 0; min-width: 300px; position: fixed; top: 2em; left: 2em;","data-role":"collapsible-set"},a+e+f);util.setHtmlEnhanced($("#popupMenuPg"),a)},init:function(){var b=util.getPropertyCount(meta64.selectedNodes),c=meta64.getHighlightedNode(),f=!util.nullOrUndef(edit.nodesToMove)&&!a.isAnonUser;util.setEnablement($("#changePasswordPgButton"),
!meta64.isAnonUser);util.setEnablement($("#accountPreferencesPgButton"),!meta64.isAnonUser);util.setEnablement($("#insertBookWarAndPeaceButton"),meta64.isAdminUser&&null!=c,meta64.isAdminUser);util.setEnablement($("#donatePgButton"),!0);util.setEnablement($("#manageAttachmentsButton"),null!=c&&!meta64.isAnonUser);util.setEnablement($("#editNodeSharingButton"),null!=c&&!meta64.isAnonUser);util.setEnablement($("#moveSelNodesButton"),null!=c&&!meta64.isAnonUser);util.setEnablement($("#renameNodePgButton"),
null!=c&&!meta64.isAnonUser);util.setEnablement($("#finishMovingSelNodesButton"),f,f);util.setEnablement($("#openExportPgButton"),meta64.isAdminUser,meta64.isAdminUser);util.setEnablement($("#openImportPgButton"),meta64.isAdminUser,meta64.isAdminUser);util.setEnablement($("#deleteSelNodesButton"),b)}};console.log("Module ready: popupMenuPg.js");return a}();console.log("running module: prefsPg.js");
var prefsPg=function(){console.log("Module ready: prefsPg.js");return{domId:"prefsPg",build:function(){var c=render.makeTag("div",{"data-role":"header"},"<h2>"+BRANDING_TITLE+" - Account Peferences</h2>"),b=render.makeRadioButton("Simple","editModeRadioGroup","editModeSimple",!0)+render.makeRadioButton("Advanced","editModeRadioGroup","editModeAdvanced",!1),b=render.makeHorzControlGroup("<legend>Edit Mode:</legend>"+b),a=render.makeButton("Save","savePreferencesButton","b","ui-btn-icon-left ui-icon-check"),
d=render.makeBackButton("Cancel","cancelPreferencesPgButton","a"),a=render.makeHorzControlGroup(a+d),d=render.makeButton("Close Account","closeAccountButton","a"),d=render.makeHorzControlGroup(d),b=render.makeTag("div",{"class":"ui-field-contain"},b+a+d),b=render.makeTag("div",{role:"main","class":"ui-content dialog-content"},""+b),c=c+b;util.setHtmlEnhanced($("#prefsPg"),c);$("#savePreferencesButton").on("click",prefs.savePreferences);$("#closeAccountButton").on("click",prefs.closeAccount)}}}();console.log("running module: renameNodePg.js");
var renameNodePg=function(){console.log("Module ready: renameNodePg.js");return{domId:"renameNodePg",build:function(){var c=render.makeTag("div",{"data-role":"header"},"<h2>"+BRANDING_TITLE+" - Rename Node</h2>"),b=render.makeEditField("Enter new name for the node","newNodeNameEditField"),a=render.makeButton("Rename","renameNodeButton","b"),d=render.makeBackButton("Close","cancelRenameNodeButton","a"),a=render.makeHorzControlGroup(a+d),b=render.makeTag("div",{"class":"ui-field-contain"},b+a),b=render.makeTag("div",
{role:"main","class":"ui-content dialog-content"},""+b),c=c+b;util.setHtmlEnhanced($("#renameNodePg"),c);$("#renameNodeButton").on("click",edit.renameNode)}}}();console.log("running module: searchPg.js");
var searchPg=function(){console.log("Module ready: searchPg.js");return{domId:"searchPg",build:function(){var c=render.makeTag("div",{"data-role":"header"},"<h2>"+BRANDING_TITLE+" - Search</h2>"),b=render.makeEditField("Search","searchText"),a=render.makeButton("Search","searchNodesButton","b","ui-btn-icon-left ui-icon-check"),d=render.makeBackButton("Close","cancelSearchButton","a"),a=render.makeHorzControlGroup(a+d),b=render.makeTag("div",{"class":"ui-field-contain"},b+a),b=render.makeTag("div",
{role:"main","class":"ui-content dialog-content"},""+b),c=c+b;util.setHtmlEnhanced($("#searchPg"),c);$("#searchNodesButton").on("click",srch.searchNodes);util.bindEnterKey("#searchText",srch.searchNodes)},init:function(){util.delayedFocus("#searchText")}}}();console.log("running module: searchResultsPg.js");
var searchResultsPg=function(){console.log("Module ready: searchResultsPg.js");return{domId:"searchResultsPg",build:function(){var c=render.makeTag("div",{"data-role":"header"},render.makeButton("Back to Content","cancelSearchResultsButton","b")+"<h2>"+BRANDING_TITLE+" - Search Results</h2>"),b=render.makeTag("div",{role:"main","class":"ui-content"},"<div id='searchResultsView'></div>"),c=c+b;util.setHtmlEnhanced($("#searchResultsPg"),c);$("#cancelSearchResultsButton").on("click",function(){meta64.jqueryChangePage("#mainPage");
view.scrollToSelectedNode()})},init:function(){srch.populateSearchResultsPage()}}}();console.log("running module: shareToPersonPg.js");
var shareToPersonPg=function(){console.log("Module ready: shareToPersonPg.js");return{domId:"shareToPersonPg",build:function(){var c=render.makeTag("div",{"data-role":"header"},"<h2>"+BRANDING_TITLE+" - Share Node to Person</h2>"),b=render.makeEditField("User to Share With","shareToUserName"),a=render.makeButton("Share","shareNodeToPersonButton","b","ui-btn-icon-left ui-icon-check"),d=render.makeBackButton("Close","cancelShareNodeToPersonButton","a"),a=render.makeHorzControlGroup(a+d),b=render.makeTag("div",
{"class":"ui-field-contain"},b+a),b=render.makeTag("div",{role:"main","class":"ui-content dialog-content"},"Enter the username of the person you want to share this node with:"+b),c=c+b;util.setHtmlEnhanced($("#shareToPersonPg"),c);$("#shareNodeToPersonButton").on("click",share.shareNodeToPerson)}}}();console.log("running module: sharingPg.js");
var sharingPg=function(){console.log("Module ready: sharingPg.js");return{domId:"sharingPg",build:function(){var c=render.makeTag("div",{"data-role":"header"},"<h2>"+BRANDING_TITLE+" - Node Sharing</h2>"),b=render.makeButton("Share with Person","shareNodeToPersonPgButton","a"),a=render.makeButton("Share to Public","shareNodeToPublicButton","a"),d=render.makeBackButton("Close","cancelSharingButton","a"),b=render.makeHorzControlGroup(b+a+d),b=render.makeTag("div",{role:"main","class":"ui-content dialog-content"},
"<div id='shareNodeNameDisplay'></div><div id='sharingListFieldContainer'></div>"+b),c=c+b;util.setHtmlEnhanced($("#sharingPg"),c);$("#shareNodeToPersonPgButton").on("click",share.shareNodeToPersonPg);$("#shareNodeToPublicButton").on("click",share.shareNodeToPublic)},init:function(){share.reload()}}}();console.log("running module: signupPg.js");
var signupPg=function(){var c={domId:"signupPg",build:function(){var b=render.makeTag("div",{"data-role":"header"},"<h2>"+BRANDING_TITLE+" - Signup</h2>"),a=render.makeEditField("User","signupUserName")+render.makePasswordField("Password","signupPassword")+render.makeEditField("Email","signupEmail")+render.makeEditField("Captcha","signupCaptcha"),d=render.makeTag("div",{"class":"captcha-image"},render.makeTag("img",{id:"captchaImage","class":"captcha",src:""},"",!1)),e=render.makeButton("Signup",
"signupButton","b","ui-btn-icon-left ui-icon-check"),f=render.makeButton("Try Different Image","tryAnotherCaptchaButton","a"),g=render.makeBackButton("Close","cancelSignupButton","a"),e=render.makeHorzControlGroup(e+f+g),a=render.makeTag("div",{"class":"ui-field-contain"},a+d+e),a=render.makeTag("div",{role:"main","class":"ui-content dialog-content",id:c.domId+"-main"},""+a),b=b+a;util.setHtmlEnhanced($("#signupPg"),b);$("#tryAnotherCaptchaButton").on("click",user.tryAnotherCaptcha);$("#signupButton").on("click",
user.signup)},init:function(){user.pageInitSignupPg();util.delayedFocus("#signupUserName")}};console.log("Module ready: signupPg.js");return c}();console.log("running module: uploadPg.js");
var uploadPg=function(){console.log("Module ready: uploadPg.js");return{domId:"uploadPg",build:function(){var c=render.makeTag("div",{"data-role":"header"},"<h2>"+BRANDING_TITLE+" - Upload File Attachment</h2>"),b=render.makeTag("div",{id:"uploadPathDisplay","class":"path-display-in-editor"},""),a=render.makeTag("input",{type:"file",name:"file"},"",!0)+render.makeTag("input",{id:"uploadFormNodeId",type:"hidden",name:"nodeId"}),a=render.makeTag("form",{id:"uploadForm",method:"POST",enctype:"multipart/form-data"},
a),a=render.makeTag("div",{id:"uploadFieldContainer"},"<p>Upload from your computer</p>"+a),d=render.makeEditField("Upload From URL","uploadFromUrl"),d=render.makeTag("div",{},d),e=render.makeButton("Upload","uploadButton","b","ui-btn-icon-left ui-icon-check"),f=render.makeButton("Delete","deleteAttachmentButton","a"),g=render.makeBackButton("Close","closeUploadButton","a"),e=render.makeHorzControlGroup(e+f+g),b=render.makeTag("div",{role:"main","class":"ui-content dialog-content"},b+a+"<div><h3>-- OR --</h3></div>"+
d+e);util.setHtmlEnhanced($("#uploadPg"),c+b);$("#uploadButton").on("click",attachment.uploadFileNow);$("#deleteAttachmentButton").on("click",attachment.deleteAttachment)},init:function(){$("#uploadFromUrl").val("");$("#uploadPathDisplay").html("Path: "+render.formatPath(attachment.uploadNode))}}}();console.log("running module: prefs.js");
var prefs=function(){var c={savePreferencesResponse:function(b){util.checkSuccess("Saving Preferences",b)&&(meta64.jqueryChangePage("#mainPage"),view.scrollToSelectedNode())},closeAccountResponse:function(){$(window).off("beforeunload");window.location.href=window.location.origin},closeAccount:function(){confirmPg.areYouSure("Oh No!","Close your Account? Are you sure? This was so unexpected!","Yes, Close Account.",function(){util.json("closeAccount",{},c.closeAccountResponse)})},savePreferences:function(){meta64.editModeOption=
$("#editModeSimple").is(":checked")?meta64.MODE_SIMPLE:meta64.MODE_ADVANCED;util.json("saveUserPreferences",{userPreferences:{advancedMode:meta64.editModeOption===meta64.MODE_ADVANCED}},c.savePreferencesResponse)},populatePreferencesPg:function(){$("#editModeSimple").prop("checked",meta64.editModeOption===meta64.MODE_SIMPLE).checkboxradio("refresh");$("#editModeAdvanced").prop("checked",meta64.editModeOption===meta64.MODE_ADVANCED).checkboxradio("refresh")},accountPreferencesPg:function(){meta64.changePage(prefsPg);
c.populatePreferencesPg()}};console.log("Module ready: prefs.js");return c}();console.log("running module: props.js");
var props=function(){var c=function(a){util.checkSuccess("Save properties",a);edit.editNode.properties.push(a.propertySaved);meta64.changePage(editNodePg);meta64.treeDirty=!0},b={propsToggle:function(){meta64.showProperties=meta64.showProperties?!1:!0;var a=$("#propsToggleButton");a.toggleClass("ui-icon-grid",meta64.showProperties);a.toggleClass("ui-icon-forbidden",!meta64.showProperties);render.renderPageFromData();view.scrollToSelectedNode();meta64.jqueryChangePage("#mainPage")},deleteProperty:function(a){confirmPg.areYouSure("Confirm Delete",
"Delete the Property","Yes, delete.",function(){b.deletePropertyImmediate(a)})},deletePropertyImmediate:function(a){util.json("deleteProperty",{nodeId:edit.editNode.id,propName:a}).done(function(b){util.checkSuccess("Delete property",b)&&(props.deletePropertyFromLocalData(a),meta64.changePage(editNodePg),meta64.treeDirty=!0)})},addProperty:function(){meta64.changePage(editPropertyPg)},populatePropertyEdit:function(){var a;a=""+render.makeTag("label",{"for":"addPropertyNameTextContent"},"Name");a+=
render.makeTag("textarea",{name:"addPropertyNameTextContent",id:"addPropertyNameTextContent",placeholder:"Enter property name"},"");a+=render.makeTag("label",{"for":"addPropertyValueTextContent"},"Value");a+=render.makeTag("textarea",{name:"addPropertyValueTextContent",id:"addPropertyValueTextContent",placeholder:"Enter property text"},"");view.initEditPathDisplayById("#editPropertyPathDisplay");util.setHtmlEnhanced($("#addPropertyFieldContainer"),a)},saveProperty:function(){var a=$("#addPropertyNameTextContent").val(),
b=$("#addPropertyValueTextContent").val();util.json("saveProperty",{nodeId:edit.editNode.id,propertyName:a,propertyValue:b},c)},addSubProperty:function(a){a=meta64.fieldIdToPropMap[a];util.isObject(a.values)||(a.values=[],a.values.push(a.value),a.value=null);a.values.push("");edit.populateEditNodePg()},clearProperty:function(a){var b=$("#"+a);0!=b.length&&b.val("");for(var c=0;1E3>c;){b=$("#"+a+"_subProp"+c);if(0==b.length)break;b.val("");c++}},deletePropertyFromLocalData:function(a){for(var b=0;b<
edit.editNode.properties.length;b++)if(a===edit.editNode.properties[b].name){edit.editNode.properties.splice(b,1);break}},makeMultiPropEditor:function(a,b,c,f){var g="",k=b.values;k&&0!=k.length||(k=[],k.push(""));for(var l=0;l<k.length;l++){console.log("prop multi-val["+l+"]="+k[l]);var m=a+"_subProp"+l,g=g+render.makeTag("label",{"for":m},(0==l?b.name:"*")+"."+l),n=f?"[binary]":k[l],g=f||c?g+render.makeTag("textarea",{id:m,readonly:"readonly",disabled:"disabled"},n?n:""):g+render.makeTag("textarea",
{id:m},n?n:"")}return g},setPreferredPropertyOrder:function(a){if(a){var b=[];$.each(a,function(a,c){c.name===jcrCnst.CONTENT?b.unshift(c):b.push(c)});return b}},renderProperties:function(a){if(a){var b="<table data-role='table' class='prop-table ui-responsive ui-shadow table-stripe property-text'>",c=0,b=b+"<thead><tr><th></th><th></th></tr></thead>",b=b+"<tbody>";$.each(a,function(a,g){if(render.allowPropertyToDisplay(g.name)){var k=render.isBinaryProperty(g.name);c++;b+="<tr class='prop-table-row'>";
b+="<td class='prop-table-name-col'>"+render.sanitizePropertyName(g.name)+"</td>";b=k?b+"<td class='prop-table-val-col'>[binary]</td>":g.values?b+("<td class='prop-table-val-col'>"+props.renderPropertyValues(g.values)+"</td>"):b+("<td class='prop-table-val-col'>"+render.wrapHtml(g.htmlValue)+"</td>");b+="</tr>"}else console.log("Hiding property: "+g.name)});return 0==c?"":b+="</tbody></table>"}},getNodeProperty:function(a,b){if(!b||!b.properties)return null;for(var c=0;c<b.properties.length;c++){var f=
b.properties[c];if(f.name===a)return f}return null},getNodePropertyVal:function(a,d){var c=b.getNodeProperty(a,d);return c?c.value:null},renderProperty:function(a){return a.values?b.renderPropertyValues(a.values):a.value&&0!=a.value.length?render.wrapHtml(a.htmlValue):""},renderPropertyValues:function(a){var b="<div>";$.each(a,function(a,c){b+=render.wrapHtml(c)+cnst.BR});return b+="</div>"}};console.log("Module ready: props.js");return b}();console.log("running module: render.js");
var render=function(){var c={buildPage:function(b){b.built||(b.build(),b.built=!0);b.init&&b.init()},renderNodeContent:function(b,a,d,e){var f="",g;g=""+c.getTopRightImageTag(b);a&&meta64.editMode&&(f+="<div class='path-display'>Path: "+c.formatPath(b)+"</div>",f+="<div>",b.createdBy&&(f+="<span class='"+(b.createdBy===meta64.userName?"created-by-me":"created-by-other")+"'>Created By: "+b.createdBy+"</span>"),f+="<span id='ownerDisplay"+b.uid+"'></span>",b.lastModified&&(f+="  Modified: "+b.lastModified),
f+="</div>");d&&!a&&b.name&&(f+="Name: "+b.name+" [uid="+b.uid+"]");f&&(g+=c.makeTag("div",{"class":"header-text"},f));if(meta64.showProperties)(a=props.renderProperties(b.properties))&&(g+=a);else if(a=props.getNodeProperty(jcrCnst.CONTENT,b))a=props.renderProperty(a),0<a.length&&(g+=c.makeTag("div",{"class":"jcr-content"},c.wrapHtml(a)));e&&b.hasBinary&&(b.binaryIsImage?b=c.makeImageTag(b):(b=c.makeTag("a",{href:c.getUrlForNodeAttachment(b)},"[Download Attachment]"),b=c.makeTag("div",{"class":"binary-link"},
b)),g=g.contains(cnst.INSERT_ATTACHMENT)?g.replaceAll(cnst.INSERT_ATTACHMENT,b):g+b);return g},renderNodeAsListItem:function(b,a,d,e){var f=b.uid,g=b.id===meta64.newChildNodeId;e=0<a&&1<e;a=a<d-1;d=b.name.startsWith("rep:")||meta64.currentNodeData.node.path.contains("/rep:");d=meta64.isAdminUser||!d;var k=meta64.getHighlightedNode();!g&&k&&k.uid===f&&(g=!0);e=c.makeRowButtonBarHtml(f,e,a,d);a=c.getNodeBkgImageStyle(b);return c.makeTag("div",{"class":"node-table-row"+(g?" active-row":" inactive-row"),
onClick:"nav.clickOnNodeRow(this, '"+f+"');",id:f+"_row",style:a},e+c.makeTag("div",{id:f+"_content"},c.renderNodeContent(b,!0,!0,!0)))},showNodeUrl:function(){var b=meta64.getHighlightedNode();if(b){var a=window.location.origin+"?id="+b.path;meta64.jqueryChangePage("#mainPage");a="URL using path: <br>"+a;(b=props.getNodePropertyVal("jcr:uuid",b))&&(a+="<p>URL for UUID: <br>"+window.location.origin+"?id="+b);messagePg.showMessage("Full External URL of Node",a)}else alert("You must first click on a node.")},
getTopRightImageTag:function(b){b=props.getNodePropertyVal("img.top.right",b);var a="";b&&(a=c.makeTag("img",{src:b,"class":"top-right-image"},"",!1));return a},getNodeBkgImageStyle:function(b){b=props.getNodePropertyVal("img.node.bkg",b);var a="";b&&(a="background-image: url("+b+");");return a},makeRowButtonBarHtml:function(b,a,d,e){var f=selButton=createSubNodeButton=editNodeButton=moveNodeUpButton=moveNodeDownButton=insertNodeButton="";c.nodeHasChildren(b)&&(f=c.makeTag("a",{onClick:"nav.openNode('"+
b+"');","class":"ui-btn ui-btn-b ui-btn-inline ui-icon-plus ui-mini ui-btn-icon-left"},"Open"));meta64.editMode&&(selButton=c.makeTag("a",{id:b+"_sel",onClick:"nav.toggleNodeSel('"+b+"');","class":"ui-btn ui-btn-inline ui-icon-check ui-mini ui-btn-icon-left "+(meta64.selectedNodes[b]?"ui-btn-b":"ui-btn-a")},"Sel"),cnst.NEW_ON_TOOLBAR&&(createSubNodeButton=c.makeTag("a",{onClick:"edit.createSubNode('"+b+"');","class":"ui-btn ui-btn-inline ui-icon-star ui-mini ui-btn-icon-left"},"New")),cnst.INS_ON_TOOLBAR&&
(insertNodeButton=c.makeTag("a",{onClick:"edit.insertNode('"+b+"');","class":"ui-btn ui-btn-inline ui-icon-bars ui-mini ui-btn-icon-left"},"Ins")));meta64.editMode&&e&&(editNodeButton=c.makeTag("a",{onClick:"edit.runEditNode('"+b+"');","class":"ui-btn ui-btn-inline ui-icon-edit ui-mini ui-btn-icon-left"},"Edit"),meta64.currentNode.childrenOrdered&&(a&&(moveNodeUpButton=c.makeTag("a",{onClick:"edit.moveNodeUp('"+b+"');","class":"ui-btn ui-btn-inline ui-icon-arrow-u ui-mini ui-btn-icon-left"},"Up")),
d&&(moveNodeDownButton=c.makeTag("a",{onClick:"edit.moveNodeDown('"+b+"');","class":"ui-btn ui-btn-inline ui-icon-arrow-d ui-mini ui-btn-icon-left"},"Dn"))));b=selButton+f+insertNodeButton+createSubNodeButton+editNodeButton+moveNodeUpButton+moveNodeDownButton;return 0<b.length?c.makeHorizontalFieldSet(b,"compact-field-contain"):""},makeHorizontalFieldSet:function(b,a){var d=c.makeTag("fieldset",{"data-role":"controlgroup","data-type":"horizontal"},b);return c.makeTag("div",{"class":"ui-field-contain"+
(a?" "+a:"")},d)},makeHorzControlGroup:function(b){return c.makeTag("div",{"data-role":"controlgroup","data-type":"horizontal"},b)},makeRadioButton:function(b,a,d,e){return c.makeTag("input",{type:"radio",name:a,id:d,checked:e?"checked":"unchecked"},"",!0)+c.makeTag("label",{"for":d},b)},nodeHasChildren:function(b){var a=meta64.uidToNodeMap[b];if(a)return a.hasChildren;console.log("Unknown nodeId in nodeHasChildren: "+b);return!1},formatPath:function(b){var a=b.path,a=meta64.isAdminUser?a:a.replaceAll("/root",
"");return a+=" ["+b.primaryTypeName+"]"},wrapHtml:function(b){return"<div data-ajax='false'>"+b+"</div>"},renderMainPageControls:function(){var b="";0<srch.numSearchResults()&&(b+=render.makeTag("a",{onClick:"nav.showSearchPage();","class":"ui-btn ui-btn-inline ui-icon-search ui-btn-icon-left"},"Back to Search Results"));var a=0<b.length;a&&util.setHtmlEnhanced($("#mainPageControls"),b);util.setVisibility("#mainPageControls",a)},renderPageFromData:function(b){var a=!1;b?a=!0:b=meta64.currentNodeData;
if(b&&b.node){util.setVisibility("#listView",!0);c.renderMainPageControls();meta64.treeDirty=!1;a&&(meta64.uidToNodeMap={},meta64.idToNodeMap={},meta64.selectedNodes={},meta64.initNode(b.node),meta64.setCurrentNodeData(b));var d="",e=c.getNodeBkgImageStyle(b.node),f=c.renderNodeContent(b.node,!0,!0,!0);if(0<f.length){var g=b.node.uid,k=g+"_row",l="";meta64.editMode&&"/"!=b.node.path&&(l=c.makeTag("a",{onClick:"edit.runEditNode('"+g+"');","class":"ui-btn ui-btn-inline ui-icon-edit ui-mini ui-btn-icon-left"},
"Edit"),l=c.makeHorizontalFieldSet(l,"compact-field-contain page-top-button-bar"));e=c.makeTag("div",{"class":"node-table-row page-parent-node inactive-row",onClick:"nav.clickOnNodeRow(this, '"+g+"');",id:k,style:e},l+f);$("#mainNodeContent").show();$("#mainNodeContent").html(e)}else $("#mainNodeContent").hide();$("#mainNodeContent").trigger("updatelayout");view.updateStatusBar();c.renderMainPageControls();if(b.children){var m=b.children.length,n=0;$.each(b.children,function(b,e){var k=c.generateRow(b,
e,a,m,n);0!=k.length&&(d+=k,n++)})}0!=d.length||meta64.isAnonUser||(d=c.makeTag("a",{onClick:"edit.createSubNode();","class":"ui-btn ui-btn-inline ui-icon-star ui-btn-icon-left"},"Create Content"));util.setHtmlEnhancedById("#listView",d);meta64.screenSizeChange();meta64.getHighlightedNode()||util.scrollToTop()}else util.setVisibility("#listView",!1),$("#mainNodeContent").html("No default content is available.")},generateRow:function(b,a,d,e,f){if(meta64.isNodeBlackListed(a))return"";d&&meta64.initNode(a);
f++;return c.renderNodeAsListItem(a,b,e,f)},getUrlForNodeAttachment:function(b){return postTargetUrl+"bin/file-name?nodeId="+encodeURIComponent(b.path)+"&ver="+b.binVer},adjustImageSize:function(b){var a=$("#"+b.imgId);a&&b.width&&b.height&&(b.width>meta64.deviceWidth-80?(a.attr("width","100%"),a.attr("height","auto")):(a.attr("width",b.width),a.attr("height",b.height)))},makeImageTag:function(b){var a=c.getUrlForNodeAttachment(b);b.imgId="imgUid_"+b.uid;if(b.width&&b.height){if(b.width>meta64.deviceWidth-
50){var d=meta64.deviceWidth-50;return c.makeTag("img",{src:a,id:b.imgId,width:d+"px",height:d*b.height/b.width+"px"},null,!1)}return c.makeTag("img",{src:a,id:b.imgId,width:b.width+"px",height:b.height+"px"},null,!1)}return c.makeTag("img",{src:a,id:b.imgId},null,!1)},makeTag:function(b,a,d,c){"undefined"===typeof c&&(c=!0);var f="<"+b;a&&(f+=" ",$.each(a,function(a,b){f=b.contains("'")?f+(a+'="'+b+'" '):f+(a+"='"+b+"' ")}));return f=c?f+(">"+d+"</"+b+">"):f+"/>"},makeEditField:function(b,a){return c.makeTag("label",
{"for":a},b)+c.makeTag("input",{type:"text",name:a,id:a},"",!0)},makePasswordField:function(b,a){return c.makeTag("label",{"for":a},b)+c.makeTag("input",{type:"password",name:a,id:a},"",!0)},makeButton:function(b,a,d,c){d="ui-btn ui-btn-inline ui-btn-"+d;c&&(d+=" "+c);return render.makeTag("a",{id:a,"class":d},b)},makeBackButton:function(b,a,d){return render.makeTag("a",{id:a,"class":"ui-btn ui-icon-carat-l ui-btn-inline ui-btn-"+d,"data-rel":"back"},b)},allowPropertyToDisplay:function(b){return null==
meta64.simpleModePropertyBlackList[b]},isReadOnlyProperty:function(b){return meta64.readOnlyPropertyList[b]},isBinaryProperty:function(b){return meta64.binaryPropertyList[b]},sanitizePropertyName:function(b){return"simple"===meta64.editModeOption?b===jcrCnst.CONTENT?"Content":b:b}};console.log("Module ready: render.js");return c}();console.log("running module: search.js");
var srch=function(){var c=function(a){b.searchResults=a;meta64.changePage(searchResultsPg)},b={searchResults:null,highlightRowNode:null,identToUidMap:{},uidToNodeMap:{},numSearchResults:function(){return null!=srch.searchResults&&null!=srch.searchResults.searchResults&&null!=srch.searchResults.searchResults.length?srch.searchResults.searchResults.length:0},searchNodes:function(){if(util.ajaxReady("searchNodes")){var a=meta64.getHighlightedNode();if(a){var b=$.trim($("#searchText").val());util.emptyString(b)?
alert("Enter search text."):util.json("nodeSearch",{nodeId:a.id,searchText:b,modSortDesc:!1},c)}else alert("No node is selected to search under.")}},timeline:function(){var a=meta64.getHighlightedNode();a?util.json("nodeSearch",{nodeId:a.id,searchText:"",modSortDesc:!0},c):alert("No node is selected to search under.")},searchPg:function(){meta64.changePage(searchPg)},initSearchNode:function(a){a.uid=util.getUidForId(b.identToUidMap,a.id);b.uidToNodeMap[a.uid]=a},populateSearchResultsPage:function(a){a||
(a=b.searchResults);var d="",c=a.searchResults.length,f=0;$.each(a.searchResults,function(a,k){meta64.isNodeBlackListed(k)||(b.initSearchNode(k),f++,d+=b.renderSearchResultAsListItem(k,a,c,f))});util.setHtmlEnhanced($("#searchResultsView"),d)},renderSearchResultAsListItem:function(a,d,c,f){d=a.uid;a.name.startsWith("rep:")||meta64.currentNodeData.node.path.contains("/rep:");return render.makeTag("div",{"class":"node-table-row inactive-row",onClick:"srch.clickOnSearchResultRow(this, '"+d+"');",id:d+
"_srch_row"},b.makeButtonBarHtml(d)+render.makeTag("div",{id:d+"_srch_content"},render.renderNodeContent(a,!0,!0,!0)))},makeButtonBarHtml:function(a){a=render.makeTag("a",{onClick:"srch.clickSearchNode('"+a+"');","class":"ui-btn ui-mini ui-btn-b ui-btn-inline ui-icon-carat-l ui-btn-icon-left"},"Go to Node");return render.makeHorizontalFieldSet(a,"compact-field-contain")},clickOnSearchResultRow:function(a,d){b.unhighlightRow();b.highlightRowNode=b.uidToNodeMap[d];util.changeOrAddClass(a,"inactive-row",
"active-row")},clickSearchNode:function(a){srch.highlightRowNode=srch.uidToNodeMap[a];view.refreshTree(srch.highlightRowNode.id,!0);meta64.jqueryChangePage("#mainPage")},unhighlightRow:function(){if(b.highlightRowNode){var a=util.domElm(b.highlightRowNode.uid+"_srch_row");a&&util.changeOrAddClass(a,"active-row","inactive-row")}}};console.log("Module ready: search.js");return b}();console.log("running module: user.js");
var share=function(){var c=function(a){d.populateSharingPg(a)},b=function(a,b){var d="";$.each(b.privileges,function(b,c){var f=render.makeTag("a",{onClick:"share.removePrivilege('"+a+"', '"+c.privilegeName+"');","class":"ui-btn ui-btn-inline ui-icon-delete ui-btn-icon-left"},"Remove"),f=render.makeHorizontalFieldSet(f),f=f+("<b>"+a+"</b> has privilege <b>"+c.privilegeName+"</b> on this node.");d+=render.makeTag("div",{"class":"privilege-entry"},f)});return d},a=function(a){util.json("getNodePrivileges",
{nodeId:d.sharingNode.path,includeAcl:!0,includeOwners:!0},c)},d={sharingNode:null,populateSharingPg:function(a){var d="<h2>Access Control Entries</h2>";$.each(a.aclEntries,function(a,c){d+="<h4>User: "+c.principalName+"</h4>";d+=render.makeTag("div",{"class":"privilege-list"},b(c.principalName,c))});""===d&&(d="Node is not shared with anyone.");util.setHtmlEnhanced($("#sharingListFieldContainer"),d)},removePrivilege:function(b,c){util.json("removePrivilege",{nodeId:d.sharingNode.id,principal:b,privilege:c},
a)},shareNodeToPersonPg:function(){meta64.changePage(shareToPersonPg)},shareNodeToPerson:function(){var a=$("#shareToUserName").val();a?util.json("addPrivilege",{nodeId:d.sharingNode.id,principal:a,privileges:["read","write","addChildren","nodeTypeManagement"]},d.reloadFromShareWithPerson):alert("Please enter a username")},shareNodeToPublic:function(){console.log("Sharing node to public.");util.json("addPrivilege",{nodeId:d.sharingNode.id,principal:"everyone",privileges:["read"]},d.reload)},editNodeSharing:function(){var a=
meta64.getHighlightedNode();a?(d.sharingNode=a,meta64.changePage(sharingPg)):alert("No node is selected.")},reloadFromShareWithPerson:function(a){util.checkSuccess("Share Node with Person",a)&&meta64.changePage(sharingPg)},reload:function(){console.log("Loading node sharing info.");util.json("getNodePrivileges",{nodeId:d.sharingNode.id,includeAcl:!0,includeOwners:!0},c)}};console.log("Module ready: share.js");return d}();console.log("running module: user.js");
var user=function(){var c=function(a){var b=BRANDING_TITLE;meta64.isAnonUser||(b+=" - "+a.userName);$("#headerUserName").html(b);a=meta64.isAnonUser;$("#openLoginPgButton").text(a?"Login":"Logout")},b=function(a){a.rootNode&&(meta64.homeNodeId=a.rootNode.id,meta64.homeNodePath=a.rootNode.path);meta64.userName=a.userName;meta64.isAdminUser="admin"===a.userName;meta64.isAnonUser="anonymous"===a.userName;meta64.anonUserLandingPageNode=a.anonUserLandingPageNode;meta64.editModeOption=a.userPreferences.advancedMode?
meta64.MODE_ADVANCED:meta64.MODE_SIMPLE},a=function(a,d,e,f){util.checkSuccess("Login",a)?("anonymous"!=d&&(g.writeCookie(cnst.COOKIE_LOGIN_USR,d),g.writeCookie(cnst.COOKIE_LOGIN_PWD,e),g.writeCookie(cnst.COOKIE_LOGIN_STATE,"1")),meta64.jqueryChangePage("#mainPage"),b(a),a.userPreferences.lastNode?console.log("lastNode: "+a.userPreferences.lastNode):console.log("lastNode is null."),d=null,util.emptyString(a.homeNodeOverride)?a.userPreferences.lastNode?(console.log("loading lastNode="+a.userPreferences.lastNode),
d=a.userPreferences.lastNode):(console.log("loading homeNodeId="+meta64.homeNodeId),d=meta64.homeNodeId):(console.log("loading homeNodeOverride="+a.homeNodeOverride),d=a.homeNodeOverride),view.refreshTree(d,!1),c(a)):f&&(alert("Cookie login failed."),$.removeCookie(cnst.COOKIE_LOGIN_USR),$.removeCookie(cnst.COOKIE_LOGIN_PWD),$.writeCookie(cnst.COOKIE_LOGIN_STATE,"0"),location.reload())},d=function(a){window.location.href=window.location.origin},e=function(a){util.checkSuccess("Change password",a)&&
alert("Password changed successfully.")},f=function(a){util.checkSuccess("Signup new user",a)&&(user.populateLoginPgFromCookies(),meta64.changePage(loginPg),alert("User Information Accepted. \n\nCheck your email for signup confirmation. (Can take up to 1 minute)"))},g={twitterLogin:function(){$(window).off("beforeunload");window.location.href=window.location.origin+"/twitterLogin"},openSignupPg:function(){meta64.changePage(signupPg)},writeCookie:function(a,b){$.cookie(a,b,{expires:365,path:"/"})},
populateLoginPgFromCookies:function(){var a=$.cookie(cnst.COOKIE_LOGIN_USR),b=$.cookie(cnst.COOKIE_LOGIN_PWD);a&&$("#userName").val(a);b&&$("#password").val(b)},openLoginPg:function(){meta64.isAnonUser?meta64.changePage(loginPg):g.logout(!0)},signup:function(){var a=util.getRequiredElement("#signupUserName").val(),b=util.getRequiredElement("#signupPassword").val(),d=util.getRequiredElement("#signupEmail").val(),c=util.getRequiredElement("#signupCaptcha").val();util.anyEmpty(a,b,d,c)?alert("Sorry, you cannot leave any fields blank."):
util.json("signup",{userName:a,password:b,email:d,captcha:c},f)},pageInitSignupPg:function(){user.tryAnotherCaptcha()},tryAnotherCaptcha:function(){var a=util.currentTimeMillis(),a=postTargetUrl+"captcha?t="+a;$("#captchaImage").attr("src",a)},refreshLogin:function(){var d,e,f=!1;if("true"===$("#loginSessionReady").text())e=d="",f=!0;else{if("0"===$.cookie(cnst.COOKIE_LOGIN_STATE)){meta64.loadAnonPageHome(!1);return}var g=$.cookie(cnst.COOKIE_LOGIN_USR),p=$.cookie(cnst.COOKIE_LOGIN_PWD),f=!util.emptyString(g)&&
!util.emptyString(p);d=g?g:"";e=p?p:""}console.log("refreshLogin with name: "+d);g=util.json("login",{userName:d,password:e,tzOffset:(new Date).getTimezoneOffset(),dst:util.daylightSavingsTime});f?g.done(function(b){a(b,d,e,f)}):g.done(function(a){b(a);c(a);meta64.loadAnonPageHome(!1)})},login:function(){var b=$.trim($("#userName").val()),d=$.trim($("#password").val());util.json("login",{userName:b,password:d,tzOffset:(new Date).getTimezoneOffset(),dst:util.daylightSavingsTime}).done(function(c){a(c,
b,d)})},logout:function(a){meta64.isAnonUser||($(window).off("beforeunload"),a&&user.writeCookie(cnst.COOKIE_LOGIN_STATE,"0"),util.json("logout",{},d))},changePassword:function(){var a=util.getRequiredElement("#changePassword1").val(),b=util.getRequiredElement("#changePassword2").val();a&&4<=a.length&&a===b?util.json("changePassword",{newPassword:a},e):alert("Sorry, invalid password(s).")},changePasswordPg:function(){meta64.changePage(changePasswordPg)}};console.log("Module ready: user.js");return g}();console.log("running module: util.js");
var util=function(){Date.prototype.stdTimezoneOffset=function(){var a=new Date(this.getFullYear(),0,1),b=new Date(this.getFullYear(),6,1);return Math.max(a.getTimezoneOffset(),b.getTimezoneOffset())};Date.prototype.dst=function(){return this.getTimezoneOffset()<this.stdTimezoneOffset()};"function"!=typeof String.prototype.startsWith&&(String.prototype.startsWith=function(a){return 0===this.indexOf(a)});"function"!=typeof String.prototype.contains&&(String.prototype.contains=function(a){return-1!=
this.indexOf(a)});"function"!=typeof String.prototype.replaceAll&&(String.prototype.replaceAll=function(a,b){return this.replace(new RegExp(a.replace(/([.*+?^=!:${}()|\[\]\/\\])/g,"\\$1"),"g"),b)});var c=0,b={daylightSavingsTime:(new Date).dst()?!0:!1,json:function(a,b,e){c++;a=$.ajax({url:postTargetUrl+a,contentType:"application/json",type:"post",dataType:"json",cache:!1,data:JSON.stringify(b)});a.done(function(a){"function"==typeof e&&e(a)});a.fail(function(a,b){var d="Server request failed.\n\n";
try{d+="Status: "+a.statusText+"\n",d+="Code: "+a.status+"\n"}catch(c){}try{d+="Response: "+JSON.parse(a.responseText).exception}catch(e){}alert(d)});a.complete(function(){c--});return a},ajaxReady:function(a){return 0<c?(console.log("Ignoring requests: "+a+". Ajax currently in progress."),!1):!0},isAjaxWaiting:function(){return 0<c},delayedFocus:function(a){setTimeout(function(){$(a).focus()},500)},checkSuccess:function(a,b){b.success||alert(a+" failed: "+b.message);return b.success},addAll:function(a,
b){for(var c=0;c<b.length;c++)b[c]?a[b[c]]=!0:console.error("null element in addAll at idx="+c)},nullOrUndef:function(a){return null===a||void 0===a},getUidForId:function(a,b){var c=a[b];c||(c=meta64.nextUid++,a[b]=c);return c},getPreviousPage:function(){var a="#"+$.mobile.activePage.prev('div[data-role="page"]')[0].id;alert("prevPage="+a);return a},domElm:function(a){if(a.contains("#"))return console.log("do not use # in domElm"),null;var b=document.getElementById(a);b&&0!=b.length||console.log("domElm Error. Required element id not found: "+
a);return b},getRequiredElement:function(a){var b=$(a);null==b&&console.log("getRequiredElement. Required element id not found: "+a);return b},isObject:function(a){return a&&0!=a.length},currentTimeMillis:function(){return(new Date).getMilliseconds()},emptyString:function(a){return!a||0==a.length},setEnablement:function(a,c,e){"undefined"===typeof e||e?b.setVisibility(a,!0):b.setVisibility(a,!1);c&&a.removeClass("ui-state-disabled");c||a.addClass("ui-state-disabled")},hookSliderChanges:function(){for(var a=
0;a<arguments.length;a++){var b=arguments[a]+"SliderChange",c=window[b];"function"!==typeof c&&alert("Function not found: "+b);if(!hookSlider("#"+arguments[a]+"Slider",c)){alert("Failed to hook slider: "+arguments[a]);break}}},hookSlider:function(a,c){b.getRequiredElement(a).change(c);return!0},bindEnterKey:function(a,c){b.bindKey(a,c,13)},bindKey:function(a,b,c){$(a).keypress(function(a){if(a.which==c)return b(),!1})},anyEmpty:function(){for(var a=0;a<arguments.length;a++){var b=arguments[a];if(!b||
0==b.length)return!0}return!1},changeOrAddClass:function(a,b,c){a=$(a);a.toggleClass(b,!1);a.toggleClass(c,!0)},changeOrAddClass__mine:function(a,b,c){if(a.className&&0!=a.className.length){for(var f=a.className.split(" "),g="",k=!1,l=0;l<f.length;l++){var m=f[l];if(m===c){if(k)continue;k=!0}else if(m===b){if(k)continue;m=c;k=!0}0<g.length&&(g+=" ");g+=m}k||(0<g.length&&(g+=" "),g+=c);a.className=g}else console.log("no existing className is available on element, so assigning to "+c),a.className=c},
verifyType:function(a,b,c){return typeof a!==b?(alert(c),!1):!0},setHtmlEnhancedById:function(a,c){var e=b.getRequiredElement(a);e?($(e).html(c),$(e).enhanceWithin()):console.log("setting failed.")},setHtmlEnhanced:function(a,b){a.html(b);a.enhanceWithin()},getPropertyCount:function(a){var b=0,c;for(c in a)a.hasOwnProperty(c)&&b++;return b},printObject:function(a){var b="";$.each(a,function(a,c){b+=a+" , "+c+"\n"});return b},printProperties:function(a){if(a){var b="";$.each(a,function(a,c){b+=a+"\n"});
return b}console.error("printProperties recieved null.")},scrollToTop:function(){window.scrollTo(0,0)},printKeys:function(a){var b="";$.each(a,function(a,c){0<b.length&&(b+=",");b+=a});return b},setVisibility:function(a,b){b?$(a).show():$(a).hide();$(a).trigger("updatelayout")}};console.log("Module ready: util.js");return b}();console.log("running module: view.js");
var view=function(){var c={updateStatusBar:function(){if(meta64.currentNodeData){var b="";meta64.editModeOption===meta64.MODE_ADVANCED&&(b+="count: "+meta64.currentNodeData.children.length);meta64.editMode&&(b+=" Selections: "+util.getPropertyCount(meta64.selectedNodes));var a=0<b.length;util.setVisibility("#mainNodeStatusBar",a);a&&util.setHtmlEnhanced($("#mainNodeStatusBar"),b)}},refreshTreeResponse:function(b,a,d){render.renderPageFromData(b);a&&d&&b.displayedParent?meta64.highlightRowById(a,!0):
c.scrollToSelectedNode();meta64.refreshAllGuiEnablement()},refreshTree:function(b,a){b||(b=meta64.currentNodeId);console.log("Refreshing tree: nodeId="+b);util.json("renderNode",{nodeId:b,renderParentIfLeaf:a?!0:!1}).done(function(d){c.refreshTreeResponse(d,b,a)})},refreshPage:function(){meta64.jqueryChangePage("#mainPage");view.refreshTree(null,!1)},scrollToSelectedNode:function(){setTimeout(function(){var b=nav.getSelectedDomElement();if(b){var a=meta64.getHighlightedNode(),b=0==meta64.getOrdinalOfNode(a)?
0:$("#"+b.id).offset().top-$("#mainPageHeader").height();$("html, body").animate({scrollTop:b})}},1E3)},initEditPathDisplayById:function(b){var a=edit.editNode;b=$(b);if(edit.editingUnsavedNode)b.html(""),b.hide();else{var c="Path: "+render.formatPath(a),c=c+("<br>ID: "+a.id),c=c+("<br>Modified: "+a.lastModified);b.html(c);b.show()}b.trigger("updatelayout")}};console.log("Module ready: view.js");return c}();
